<form #normalForm="ngForm" (ngSubmit)="onSubmit(normalForm)" autocomplete="off">
  <div ibmCol [columnNumbers]="{ lg: 6, md: 6, sm: 6 }">
    <input type="hidden" [(ngModel)]="mheForm.requestType" name="requestType" />

    <div class="form-item">
      <ibm-label>Booking Type</ibm-label>
      <ibm-radio-group
        name="bookingType"
        [(ngModel)]="mheForm.bookingType"
        (change)="onChange($event)"
      >
        <ibm-radio
          style="margin-right: 70px"
          *ngFor="let radio of typeOfBooking"
          [value]="radio.type"
          [checked]="radio.checked"
          [disabled]="radio.type != 'Daily'"
        >
          {{ radio.type }}
        </ibm-radio>
      </ibm-radio-group>
    </div>

    <div
      class="form-item"
      *ngIf="mheForm.bookingType == 'Daily'"
      #singleDateElement
      tabindex="4"
    >
      <ibm-date-picker
        label="Booking Date"
        [placeholder]="placeholder"
        [size]="size"
        [dateFormat]="dateFormat"
        [(ngModel)]="mheForm.singleDate"
        name="singleDate"
        [invalid]="invalidSingleDate"
        [invalid]="backDatedDate"
        required
        (change)="dateValueChange($event)"
      >
      </ibm-date-picker>
      <div *ngIf="mheForm.singleDate && backDatedDate && !dateFlag" class="invalid-class-label">
        Please select after today's date
      </div>
      <div *ngIf="backDatedDate && dateFlag" class="invalid-class-label">
        Selected date is not available. Please change to the next day date
      </div>
      <div *ngIf="invalidSingleDate" class="invalid-class-label">
        Date Required
      </div>
    </div>

    <div
    class="form-item date-layout"
    #rangeDateElement
    tabindex="4"
    *ngIf="mheForm.bookingType == 'Recurring'"
    style="padding-top: 0px"
  >
    <div *ngFor="let newRange of rangeDateRow; let i = index" class="d-flex">
      <ibm-date-picker
        style="padding-top: 32px"
        label="Start Date"
        rangeLabel="End Date"
        [size]="size"
        [range]="true"
        [placeholder]="placeholder"
        [dateFormat]="dateFormat"
        name="rangeDate_{{ newRange.id }}"
        [(ngModel)]="newRange.date"
        [invalid]="dateWarning[newRange.id]"
        [rangeInvalid]="rangeDateWarning[newRange.id]"
        required
        (change)="dateValueChange($event)"
      >
      </ibm-date-picker>
      <div
        *ngIf="
          invalidbackDateds[newRange.id] &&
          !rangeInvalidRangeDate[newRange.id] &&
          !invalidRangeDate[newRange.id]
        "
        class="invalid-class-label"
      >
        Please select today's date or after today's date
      </div>
      <div *ngIf="invalidRangeDate[newRange.id]" class="invalid-class-label">
        Date Required
      </div>
      <div
        *ngIf="
          rangeInvalidRangeDate[newRange.id] && !invalidRangeDate[newRange.id]
        "
        class="invalid-class-label"
      >
        Current recurring date is clash with the previous recurring date
      </div>

      <div class="icon-close" *ngIf="i > 0">
        <div
          ibmIcon="close--filled"
          size="20"
          (click)="deleteRangeDate(i)"
        ></div>
      </div>
    </div>

    <!-- <div *ngIf="dateErr === true">
          <ibm-notification class="dateErr" [notificationObj]="{
              type: 'error',
              template: customNotificationContent,
              title: 'Sample notification',
              showClose: false,
              lowContrast: true
          }">
          </ibm-notification>
          <ng-template #customNotificationContent let-data>
              <p ibmNotificationTitle>Notice:</p>
              <p ibmNotificationSubtitle>The date is previous to today's date. Your start date is {{rangeDateFirstIndex}}</p>
          </ng-template>
      </div> -->

    <div class="pt-16">
      <button
        ibmButton="primary"
        size="sm"
        type="button"
        (click)="addRangeDate()"
      >
        Add New Range
      </button>
    </div>
  </div>

    <div class="form-item" #requestOnBehalfElement tabindex="1">
      <ibm-combo-box
        label="Request On Behalf"
        placeholder="Choose an option"
        itemValueKey="content"
        [dropUp]="false"
        name="requestOnBehalf"
        [(ngModel)]="mheForm.requestOnBehalf"
        invalidText="Request On Behalf Required"
        [invalid]="invalidRequestOnBehalf"
        required
        (selected)="inputValueChange()"
        [items]="requestOnBehalfList"
      >
        <ibm-dropdown-list></ibm-dropdown-list>
      </ibm-combo-box>
    </div>

    <div class="form-item">
      <ibm-label
        [invalid]="invalidJobDescription"
        invalidText="Job Description Required"
      >
        Job Description
        <textarea
          #jobDescriptionElement
          tabindex="2"
          ibmTextArea
          aria-label="textarea"
          maxlength="100"
          [rows]="6"
          name="jobDescription"
          [(ngModel)]="mheForm.jobDescription"
          [invalid]="invalidJobDescription"
          required
          (ngModelChange)="inputValueChange()"
        >
        </textarea>
      </ibm-label>
    </div>

    <div class="form-item invalid-icon-50">
      <ibm-label
        [invalid]="invalidPONum"
        invalidText="PO Number Required"
        helperText="Please insert dash (-) if not applicable"
      >
        PO No
        <input
          #PoNumberElement
          tabindex="3"
          ibmText
          type="text"
          name="PONum"
          [(ngModel)]="mheForm.PONum"
          [invalid]="invalidPONum"
          required
          (ngModelChange)="inputValueChange()"
        />
      </ibm-label>
    </div>

    <div class="form-item">
      <ibm-label>
        Remarks (Optional)
        <textarea
          ibmTextArea
          aria-label="textarea"
          maxlength="100"
          [rows]="6"
          name="remarks"
          [(ngModel)]="mheForm.remarks"
        ></textarea>
      </ibm-label>
    </div>


    <div class="singleDate-notif">
      <div class="pt-16" *ngIf="dateFlag == true && backDatedDate == false">
        <ibm-toast
          style="width: 100%"
          [notificationObj]="{
            type: 'info',
            template: customToastContent,
            lowContrast: true,
            title: 'Next Day Booking is closed for this date.',
            myData: {
              subtitle:
                'Any bookings made for this date will be included in the waiting list.'
            },
            showClose: showClose
          }"
        >
        </ibm-toast>
        <ng-template #customToastContent let-data>
          <div class="d-flex">
            <div>
              <p class="ph01" style="margin-bottom: 0px" ibmToastTitle>
                {{ data.title }}
              </p>
              <p ibmToastSubtitle>{{ data.myData.subtitle }}</p>
            </div>
            <div class="secondary-toast-button">
              <button
                class="singleDate-notif-btn"
                ibmButton="ghost"
                size="sm"
                #trigger
                type="button"
                (click)="open = true"
              >
                More Info
              </button>
            </div>
          </div>
        </ng-template>
      </div>
    </div>

    <div>
      <ibm-modal [open]="open" (overlaySelected)="open = false">
        <ibm-modal-header (closeSelect)="open = false">
          <p class="bx--modal-header__label bx--type-delta">Notice</p>
          <p class="bx--modal-header__heading bx--type-beta">
            Your Request will be Placed in The Waiting List
          </p>
        </ibm-modal-header>
        <div class="bx--modal-content">
          <p>
            Any Next Day bookings made after <b>15:00</b> or made on the same
            day will be included in the <b>Waiting List.</b> <br /><br />
            Your request will be considered according to the available slots
            based on the arrangement that has been made for the selected date.
            <br /><br />
            You may create another Next Day booking before 15:00 if you wish to
            have your request scheduled as normal. <br /><br />
            In case there are no slots available, our personnel will be in touch
            with you. <br /><br />
            To cancel your booking, kindly contact KSB. <br /><br />
            Thank you.
          </p>
        </div>
        <ibm-modal-footer>
          <ng-container>
            <button
              ibmButton="primary"
              (click)="open = false"
              [attr.modal-primary-focus]="true"
            >
              Continue
            </button>
          </ng-container>
        </ibm-modal-footer>
      </ibm-modal>
    </div>

  </div>

  <div ibmCol class="pt-32" [columnNumbers]="{ lg: 12, md: 10, sm: 6 }">
    <div class="form-item">
      <div *ngIf="noTableSelected" class="invalid-class-label">
        <p class="ph01">Please request at least one item.</p>
      </div>

      <div *ngIf="falseState" class="invalid-class-label">
        <p class="ph01">Please request at least one item.</p>
      </div>
      <ibm-table-container>
        <ibm-table-header>
          <h4 ibmTableHeaderTitle>Machinery</h4>
          <p ibmTableHeaderDescription>{{ description }}</p>
        </ibm-table-header>
        <ibm-table-toolbar>
          <ibm-table-toolbar-content *ngIf="!checkLengthMachinery()">
            <button
              style="
                padding: calc(0.375rem - 3px) 60px calc(0.375rem - 3px) 12px;
              "
              ibmButton="primary"
              size="sm"
              type="button"
              (click)="addMachineryRow()"
            >
              Add Item
              <div class="icon-addAlt" ibmIcon="add--alt" size="20"></div>
            </button>
          </ibm-table-toolbar-content>
          <div class="table-action" *ngIf="checkLengthMachinery()">
            <div class="selectedItem">
              {{ counterMachinery }}
              <span *ngIf="counterMachinery == 1">item</span
              ><span *ngIf="counterMachinery > 1">items</span> selected
            </div>
            <div class="actions">
              <div class="del">
                <Button
                  ibmButton="primary"
                  size="sm"
                  type="button"
                  (click)="deleteMachinery()"
                >
                  Delete
                  <div
                    class="icon-trashCan"
                    ibmIcon="trash-can"
                    size="20"
                  ></div>
                </Button>
              </div>
              <div class="cancel">
                <button
                  ibmButton="primary"
                  size="sm"
                  type="button"
                  (click)="cancelMethodMachinery()"
                >
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </ibm-table-toolbar>
        <div class="" #machineryTableElement tabindex="6">
          <table class="bx--data-table">
            <thead>
              <tr>
                <th>No.</th>
                <th>Item</th>
                <th>Programme</th>
                <th>Quantity</th>
                <th>Time</th>
                <th>Estimated Hours</th>
                <th>Location</th>
                <th *ngIf="special">Specific Crew</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngIf="machineryRow.length == 0"
                [ngClass]="{ 'invalid-tableRow': machineryTableInvalid }"
              >
                <td align="center" colspan="9">
                  No data is entered yet. Please add new row
                </td>
              </tr>
              <tr
                *ngFor="let newMachinery of machineryRow; let postIndex = index"
                class="white-bg"
                [ngClass]="{ 'invalid-tableRow': machineryTableInvalid }"
              >
                <td>{{ postIndex + 1 }}</td>
                <td>
                  <ibm-combo-box
                    placeholder="Select"
                    [dropUp]="false"
                    [items]="itemList"
                    itemValueKey="content"
                    name="item_{{ newMachinery.id }}"
                    [(ngModel)]="newMachinery.Item"
                    [invalid]="invalidItemMachinery[postIndex]"
                    invalidText="Item Required"
                    (selected)="dropdownValueChange()"
                    (selected)="
                      specificCrewDependency(newMachinery.Item, newMachinery.id)
                    "
                    (selected)="addRequired(postIndex)"
                  >
                    <ibm-dropdown-list></ibm-dropdown-list>
                  </ibm-combo-box>
                </td>
                <td>
                  <ibm-dropdown
                    placeholder="Select"
                    [dropUp]="false"
                    itemValueKey="content"
                    name="programme_{{ newMachinery.id }}"
                    [(ngModel)]="newMachinery.Programme"
                    [invalid]="invalidProgrammeMachinery[postIndex]"
                    invalidText="Programme Required"
                    [required]="requiredMachinery[postIndex]"
                    (selected)="inputValueChange()"
                    itemValueKey="value"
                  >
                    <ibm-dropdown-list [items]="programme"></ibm-dropdown-list>
                  </ibm-dropdown>
                </td>
                <td>
                  <ibm-number
                    [step]="step"
                    [min]="min"
                    [max]="max"
                    name="quantity_{{ newMachinery.id }}"
                    [(ngModel)]="newMachinery.Quantity"
                    [invalid]="invalidQuantityMachinery[postIndex]"
                    invalidText="Quantity Required"
                    [required]="requiredMachinery[postIndex]"
                    (change)="inputValueChange()"
                    (click)="inputValueChange()"
                  >
                  </ibm-number>
                </td>
                <td>
                  <ibm-dropdown
                    placeholder="{{
                      newMachinery.Time ? newMachinery.Time : 'Select Time'
                    }}"
                    [dropUp]="false"
                    itemValueKey="content"
                    name="time_{{ newMachinery.id }}"
                    [(ngModel)]="newMachinery.Time"
                    invalidText="Time Required"
                    [invalid]="invalidTimeMachinery[postIndex]"
                    [required]="requiredMachinery[postIndex]"
                    (selected)="dropdownValueChange()"
                  >
                    <ibm-dropdown-list [items]="timeArr"></ibm-dropdown-list>
                  </ibm-dropdown>
                </td>
                <td>
                  <ibm-number
                    [step]="step"
                    [min]="min"
                    [max]="max"
                    name="EHM_{{ newMachinery.id }}"
                    [(ngModel)]="newMachinery.EstimatedHours"
                    [invalid]="invalidEHMachinery[postIndex]"
                    invalidText="Estimated Hours Required"
                    [required]="requiredMachinery[postIndex]"
                    (change)="inputValueChange()"
                    (click)="inputValueChange()"
                  >
                  </ibm-number>
                </td>
                <td>
                  <ibm-combo-box
                    placeholder="Select"
                    [dropUp]="false"
                    [items]="sitesList"
                    itemValueKey="content"
                    name="location_{{ newMachinery.id }}"
                    [(ngModel)]="newMachinery.Location"
                    invalidText="Location Required"
                    [invalid]="invalidLocationMachinery[postIndex]"
                    [required]="requiredMachinery[postIndex]"
                    (selected)="dropdownValueChange()"
                  >
                    <ibm-dropdown-list></ibm-dropdown-list>
                  </ibm-combo-box>
                </td>
                <td *ngIf="special">
                  <!-- <ibm-dropdown
                    placeholder="Select"
                    [dropUp]="false"
                    itemValueKey="content"
                    name="specificCrew_{{ newMachinery.id }}"
                    [(ngModel)]="newMachinery.SpecificCrew[postIndex]"
                    [disabled]="disabled[newMachinery.id]"
                    (selected)="specificCrewValue(postIndex, $event)"
                    [invalid]="invalidSpecificCrewMachinery[postIndex]"
                    invalidText="Specific Crew Required"
                    [required]="requiredMachinery[postIndex]"
                    required
                  > -->
                  <ibm-dropdown
                    placeholder="Select"
                    [dropUp]="false"
                    itemValueKey="content"
                    name="specificCrew_{{ newMachinery.id }}"
                    [disabled]="disabled[newMachinery.id]"
                    (selected)="specificCrewValue(postIndex, $event)"
                  >
                    <ibm-dropdown-list
                      [items]="machineSpecificCrewList[newMachinery.id]"
                    ></ibm-dropdown-list>
                  </ibm-dropdown>
                  <input
                    type="hidden"
                    name="specificCrew_{{ newMachinery.id }}"
                    [(ngModel)]="newMachinery.SpecificCrew"
                  />
                </td>
                <td>
                  <ibm-checkbox
                    name="checkbox_{{ newMachinery.id }}"
                    [(ngModel)]="newMachinery.Selected"
                    (ngModelChange)="checkboxChange('machinery', $event)"
                  >
                  </ibm-checkbox>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </ibm-table-container>
    </div>
  </div>

  <div ibmCol class="pt-32" [columnNumbers]="{ lg: 12, md: 10, sm: 6 }">
    <div class="form-item">
      <ibm-table-container>
        <ibm-table-header>
          <h4 ibmTableHeaderTitle>Manpower</h4>
          <p ibmTableHeaderDescription>{{ description }}</p>
        </ibm-table-header>
        <ibm-table-toolbar>
          <ibm-table-toolbar-content *ngIf="!checkLengthManPower()">
            <button
              style="
                padding: calc(0.375rem - 3px) 60px calc(0.375rem - 3px) 12px;
              "
              ibmButton="primary"
              size="sm"
              type="button"
              (click)="addManPowerRow()"
            >
              Add Item
              <div class="icon-addAlt" ibmIcon="add--alt" size="20"></div>
            </button>
          </ibm-table-toolbar-content>
          <div class="table-action" *ngIf="checkLengthManPower()">
            <div class="selectedItem">
              {{ counterManpower }}
              <span *ngIf="counterManpower == 1">item</span
              ><span *ngIf="counterManpower > 1">items</span> selected
            </div>
            <div class="actions">
              <div class="del">
                <Button
                  ibmButton="primary"
                  size="sm"
                  type="button"
                  (click)="deleteManPower()"
                >
                  Delete
                  <div
                    class="icon-trashCan"
                    ibmIcon="trash-can"
                    size="20"
                  ></div>
                </Button>
              </div>
              <div class="cancel">
                <button
                  ibmButton="primary"
                  size="sm"
                  type="button"
                  (click)="cancelMethodManPower()"
                >
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </ibm-table-toolbar>
        <div class="" #manPowerTableElement tabindex="7">
          <table class="bx--data-table">
            <thead>
              <tr>
                <th>
                  <span class="bx--table-header-label">No.</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Item</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Programme</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Quantity</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Time</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Estimated Hours</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Location</span>
                </th>
                <th *ngIf="special">
                  <span class="bx--table-header-label">Specific Crew</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Action</span>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngIf="manPowerRow.length == 0"
                [ngClass]="{ 'invalid-tableRow': manPowerTableInvalid }"
              >
                <td align="center" colspan="8">
                  No data is entered yet. Please add new row
                </td>
              </tr>
              <tr
                *ngFor="let manPower of manPowerRow; let postIndex = index"
                class="white-bg"
                [ngClass]="{ 'invalid-tableRow': manPowerTableInvalid }"
              >
                <td>{{ postIndex + 1 }}</td>
                <td>
                  <ibm-combo-box
                    placeholder="Select"
                    [dropUp]="false"
                    [items]="manPoweritemList"
                    itemValueKey="content"
                    name="item_{{ manPower.id }}"
                    [(ngModel)]="manPower.Item"
                    [invalid]="invalidItemManPower[postIndex]"
                    invalidText="Item Required"
                    (selected)="dropdownValueChange(manPower.Item)"
                    (selected)="
                      MPspecificCrewDependency(manPower.Item, manPower.id)
                    "
                    (selected)="addRequired(postIndex)"
                  >
                    <ibm-dropdown-list></ibm-dropdown-list>
                  </ibm-combo-box>
                </td>
                <td>
                  <ibm-dropdown
                    placeholder="Select"
                    [dropUp]="false"
                    itemValueKey="content"
                    name="programme_{{ manPower.id }}"
                    [(ngModel)]="manPower.Programme"
                    [invalid]="invalidProgrammeManpower[postIndex]"
                    invalidText="Programme Required"
                    [required]="requiredManPower[postIndex]"
                    (selected)="inputValueChange()"
                    itemValueKey="value"
                  >
                    <ibm-dropdown-list [items]="programme"></ibm-dropdown-list>
                  </ibm-dropdown>
                </td>
                <td>
                  <ibm-number
                    [step]="step"
                    [min]="min"
                    [max]="max"
                    name="manpower_quantity_{{ manPower.id }}"
                    [(ngModel)]="manPower.Quantity"
                    [invalid]="invalidQuantityManPower[postIndex]"
                    invalidText="Quantity Required"
                    [required]="requiredManPower[postIndex]"
                    (change)="inputValueChange()"
                    (click)="inputValueChange()"
                  >
                  </ibm-number>
                </td>
                <td>
                  <ibm-dropdown
                    placeholder="{{
                      manPower.Time ? manPower.Time : 'Select Time'
                    }}"
                    [dropUp]="false"
                    itemValueKey="content"
                    name="time_{{ manPower.id }}"
                    [(ngModel)]="manPower.Time"
                    invalidText="Time Required"
                    [invalid]="invalidTimeManPower[postIndex]"
                    [required]="requiredManPower[postIndex]"
                    (selected)="dropdownValueChange()"
                  >
                    <ibm-dropdown-list [items]="timeArr"></ibm-dropdown-list>
                  </ibm-dropdown>
                </td>
                <td>
                  <ibm-number
                    [step]="step"
                    [min]="min"
                    [max]="max"
                    name="EHMP_{{ manPower.id }}"
                    [(ngModel)]="manPower.EstimatedHours"
                    invalidText="Estimated Hours Required"
                    [invalid]="invalidEHManPower[postIndex]"
                    [required]="requiredManPower[postIndex]"
                    (change)="inputValueChange()"
                    (click)="inputValueChange()"
                  >
                  </ibm-number>
                </td>
                <td>
                  <ibm-combo-box
                    placeholder="Select"
                    [dropUp]="false"
                    [items]="sitesList"
                    itemValueKey="content"
                    name="location_{{ manPower.id }}"
                    [(ngModel)]="manPower.Location"
                    invalidText="Location Required"
                    [invalid]="invalidLocationManPower[postIndex]"
                    [required]="requiredManPower[postIndex]"
                    (selected)="dropdownValueChange()"
                  >
                    <ibm-dropdown-list></ibm-dropdown-list>
                  </ibm-combo-box>
                </td>
                <td *ngIf="special">
                  <!-- <ibm-dropdown
                    placeholder="Select"
                    [dropUp]="false"
                    itemValueKey="content"
                    name="specificCrew_{{ manPower.id }}"
                    [(ngModel)]="manPower.SpecificCrew[postIndex]"
                    [disabled]="MPdisabled[manPower.id]"
                    (selected)="MPspecificCrewValue(postIndex, $event)"
                    [invalid]="invalidSpecificCrewManpower[postIndex]"
                    invalidText="Specific Crew Required"
                    [required]="requiredManPower[postIndex]"
                    required
                  > -->
                  <ibm-dropdown
                    placeholder="Select"
                    [dropUp]="false"
                    itemValueKey="content"
                    name="specificCrew_{{ manPower.id }}"
                    [disabled]="MPdisabled[manPower.id]"
                    (selected)="MPspecificCrewValue(postIndex, $event)"
                    [invalid]="invalidSpecificCrewManpower[postIndex]"
                  >
                    <ibm-dropdown-list
                      [items]="manPowerSpecificCrewList[manPower.id]"
                    ></ibm-dropdown-list>
                  </ibm-dropdown>
                  <input
                    type="hidden"
                    name="specificCrew_{{ manPower.id }}"
                    [(ngModel)]="manPower.SpecificCrew"
                  />
                </td>
                <td>
                  <ibm-checkbox
                    name="checkbox_{{ manPower.id }}"
                    [(ngModel)]="manPower.Selected"
                    (ngModelChange)="checkboxChange('manpower', $event)"
                  >
                  </ibm-checkbox>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </ibm-table-container>
    </div>
  </div>

  <!-- <div ibmCol class="pt-32" [columnNumbers]="{ lg: 12, md: 10, sm: 6 }">
    <div class="form-item">
      <ibm-table-container>
        <ibm-table-header>
          <h4 ibmTableHeaderTitle>Equipment</h4>
          <p ibmTableHeaderDescription>{{ description }}</p>
        </ibm-table-header>
        <ibm-table-toolbar>
          <ibm-table-toolbar-content *ngIf="!checkLengthOtherMachineries()">
            <button
              style="
                padding: calc(0.375rem - 3px) 60px calc(0.375rem - 3px) 12px;
              "
              ibmButton="primary"
              size="sm"
              type="button"
              (click)="addOtherMachineriesRow()"
            >
              Add Item
              <div class="icon-addAlt" ibmIcon="add--alt" size="20"></div>
            </button>
          </ibm-table-toolbar-content>
          <div class="table-action" *ngIf="checkLengthOtherMachineries()">
            <div class="selectedItem">
              {{ counterEquipment }}
              <span *ngIf="counterEquipment == 1">item</span
              ><span *ngIf="counterEquipment > 1">items</span> selected
            </div>
            <div class="actions">
              <div class="del">
                <Button
                  ibmButton="primary"
                  size="sm"
                  type="button"
                  (click)="deleteOtherMachineries()"
                >
                  Delete
                  <div
                    class="icon-trashCan"
                    ibmIcon="trash-can"
                    size="20"
                  ></div>
                </Button>
              </div>
              <div class="cancel">
                <button
                  ibmButton="primary"
                  size="sm"
                  type="button"
                  (click)="cancelMethodOtherMachineries()"
                >
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </ibm-table-toolbar>
        <div class="" #equipmentTableElement tabindex="8">
          <table class="bx--data-table">
            <thead>
              <tr>
                <th>
                  <span class="bx--table-header-label">No.</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Item</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Programme</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Quantity</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Time</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Estimated Hours</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Location</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Action</span>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngIf="otherMachineriesRow.length == 0"
                [ngClass]="{ 'invalid-tableRow': otherMachineriesTableInvalid }"
              >
                <td align="center" colspan="8">
                  No data is entered yet. Please add new row
                </td>
              </tr>
              <tr
                *ngFor="
                  let otherMachine of otherMachineriesRow;
                  let postIndex = index
                "
                [ngClass]="{ 'invalid-tableRow': otherMachineriesTableInvalid }"
                class="white-bg"
              >
                <td>{{ postIndex + 1 }}</td>
                <td>
                  <ibm-combo-box
                    placeholder="Select"
                    [dropUp]="false"
                    [items]="equipmentItemList"
                    itemValueKey="content"
                    [invalid]="invalidItemOtherMachine[postIndex]"
                    invalidText="Item Required"
                    name="equipment_item_{{ otherMachine.id }}"
                    [(ngModel)]="otherMachine.Item"
                    (selected)="addRequired(postIndex)"
                    (selected)="dropdownValueChange()"
                  >
                    <ibm-dropdown-list></ibm-dropdown-list>
                  </ibm-combo-box>
                </td>
                <td>
                  <ibm-dropdown
                    placeholder="Select"
                    [dropUp]="false"
                    itemValueKey="content"
                    name="equipment_programme_{{ otherMachine.id }}"
                    [(ngModel)]="otherMachine.Programme"
                    [invalid]="invalidProgrammeEquipment[postIndex]"
                    invalidText="Programme Required"
                    [required]="requiredOtherMachineries[postIndex]"
                    (selected)="inputValueChange(postIndex)"
                    itemValueKey="value"
                  >
                    <ibm-dropdown-list [items]="programme"></ibm-dropdown-list>
                  </ibm-dropdown>
                </td>
                <td>
                  <ibm-number
                    [step]="step"
                    [min]="min"
                    [max]="max"
                    [invalid]="invalidQuantityOtherMachine[postIndex]"
                    invalidText="Equipment_Quantity Required"
                    name="equipment_quantity_{{ otherMachine.id }}"
                    [(ngModel)]="otherMachine.Quantity"
                    [required]="requiredOtherMachineries[postIndex]"
                    (change)="inputValueChange()"
                    (click)="inputValueChange()"
                  ></ibm-number>
                </td>
                <td>
                  <ibm-dropdown
                    placeholder="{{
                      otherMachine.Time ? otherMachine.Time : 'Select Time'
                    }}"
                    [dropUp]="false"
                    itemValueKey="content"
                    [invalid]="invalidTimeOtherMachine[postIndex]"
                    invalidText="Time Required"
                    name="equipment_time_{{ otherMachine.id }}"
                    [(ngModel)]="otherMachine.Time"
                    [required]="requiredOtherMachineries[postIndex]"
                    (selected)="dropdownValueChange()"
                  >
                    <ibm-dropdown-list [items]="timeArr"></ibm-dropdown-list>
                  </ibm-dropdown>
                </td>
                <td>
                  <ibm-number
                    [step]="step"
                    [min]="min"
                    [max]="max"
                    [invalid]="invalidEHOtherMachine[postIndex]"
                    invalidText="Estimated Hours Required"
                    name="equipment_EHOM_{{ otherMachine.id }}"
                    [(ngModel)]="otherMachine.EstimatedHours"
                    [required]="requiredOtherMachineries[postIndex]"
                    (change)="inputValueChange()"
                    (click)="inputValueChange()"
                  ></ibm-number>
                </td>
                <td>
                  <ibm-combo-box
                    placeholder="Select"
                    [dropUp]="false"
                    [items]="sitesList"
                    itemValueKey="content"
                    [invalid]="invalidLocationOtherMachine[postIndex]"
                    invalidText="Location Required"
                    name="equipment_location_{{ otherMachine.id }}"
                    [(ngModel)]="otherMachine.Location"
                    [required]="requiredOtherMachineries[postIndex]"
                    (selected)="dropdownValueChange()"
                  >
                    <ibm-dropdown-list></ibm-dropdown-list>
                  </ibm-combo-box>
                </td>
                <td>
                  <ibm-checkbox
                    name="equipment_checkbox_{{ otherMachine.id }}"
                    [(ngModel)]="otherMachine.Selected"
                    (ngModelChange)="checkboxChange('equipment', $event)"
                  >
                  </ibm-checkbox>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </ibm-table-container>
    </div>
  </div> -->

  <!-- <div ibmCol class="pt-32" [columnNumbers]="{ lg: 12, md: 10, sm: 6 }">
    <div class="form-item">
      <ibm-table-container>
        <ibm-table-header>
          <h4 ibmTableHeaderTitle>External Item</h4>
          <p ibmTableHeaderDescription>
            Please contact KSB for any external request
          </p>
          <p ibmTableHeaderDescription>{{ description }}</p>
        </ibm-table-header>
        <ibm-table-toolbar>
          <ibm-table-toolbar-content *ngIf="!checkLengthExternalItem()">
            <button
              style="
                padding: calc(0.375rem - 3px) 60px calc(0.375rem - 3px) 12px;
              "
              ibmButton="primary"
              size="sm"
              type="button"
              (click)="addExternalItemRow()"
            >
              Add Item
              <div class="icon-addAlt" ibmIcon="add--alt" size="20"></div>
            </button>
          </ibm-table-toolbar-content>
          <div class="table-action" *ngIf="checkLengthExternalItem()">
            <div class="selectedItem">
              {{ counterExternal }}
              <span *ngIf="counterExternal == 1">item</span
              ><span *ngIf="counterExternal > 1">items</span> selected
            </div>
            <div class="actions">
              <div class="del">
                <Button
                  ibmButton="primary"
                  size="sm"
                  type="button"
                  (click)="deleteExternalItem()"
                >
                  Delete
                  <div
                    class="icon-trashCan"
                    ibmIcon="trash-can"
                    size="20"
                  ></div>
                </Button>
              </div>
              <div class="cancel">
                <button
                  ibmButton="primary"
                  size="sm"
                  type="button"
                  (click)="cancelMethodExternalItem()"
                >
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </ibm-table-toolbar>
        <div class="" #externalItemTableElement tabindex="9">
          <table class="bx--data-table">
            <thead>
              <tr>
                <th>
                  <span class="bx--table-header-label">No.</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Quotation ID</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Item</span>
                </th>
                <th>
                  <span class="bx--table-header-label">UOM</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Qty.</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Rent Period</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Unit</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Time</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Location</span>
                </th>
                <th>
                  <span class="bx--table-header-label">Action</span>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngIf="externalItemRow.length == 0"
                [ngClass]="{ 'invalid-tableRow': externalItemTableInvalid }"
              >
                <td align="center" colspan="10">
                  No data is entered yet. Please add new row
                </td>
              </tr>
              <tr
                *ngFor="let external of externalItemRow; let postIndex = index"
                [ngClass]="{ 'invalid-tableRow': externalItemTableInvalid }"
                class="white-bg"
              >
                <td>{{ postIndex + 1 }}</td>
                <td>
                  <ibm-dropdown
                    placeholder="Select"
                    [dropUp]="false"
                    itemValueKey="content"
                    [invalid]="invalidQuotationIDExternalItem[postIndex]"
                    invalidText="Quotation Required"
                    name="quotationID_{{ external.id }}"
                    [(ngModel)]="external.quotation"
                    (selected)="addRequired(postIndex)"
                    (selected)="dropdownValueChange()"
                    (selected)="
                      specificItem(external.quotation, external.id, postIndex)
                    "
                  >
                    <ibm-dropdown-list
                      [items]="QuotationIDList"
                    ></ibm-dropdown-list>
                  </ibm-dropdown>
                </td>
                <td>
                  <input
                    ibmText
                    type="text"
                    placeholder="EA"
                    name="external_item_item_{{ external.id }}"
                    [(ngModel)]="external.Item"
                    (change)="inputValueChange()"
                    readonly
                  />
                </td>
                <td style="width: 9%">
                  <input
                    ibmText
                    type="text"
                    placeholder="EA"
                    name="external_item_UOM_{{ external.id }}"
                    [(ngModel)]="external.UOM"
                    (change)="inputValueChange()"
                    readonly
                  />
                </td>
                <td style="width: 9%">
                  <ibm-number
                    [step]="step"
                    [invalid]="invalidQuantityExternalItem[postIndex]"
                    invalidText="Invalid Qty"
                    name="external_item_quantity_{{ external.id }}"
                    [(ngModel)]="external.Quantity"
                    [required]="requiredExternalItem[postIndex]"
                    (change)="inputValueChange()"
                    (click)="inputValueChange()"
                    [min]="0"
                    [max]="maxQuantity[postIndex]"
                  ></ibm-number>
                </td>
                <td style="width: 10%">
                  <ibm-number
                    [step]="step"
                    [invalid]="invalidRentPeriodExternalItem[postIndex]"
                    invalidText="Invalid Rent Period"
                    name="rentPeriod_{{ external.id }}"
                    [(ngModel)]="external.RentPeriod"
                    [required]="requiredExternalItem[postIndex]"
                    (change)="inputValueChange()"
                    (click)="inputValueChange()"
                    [min]="0"
                    [max]="10"
                  ></ibm-number>
                </td>
                <td>
                  <input
                    ibmText
                    type="number"
                    placeholder="EA"
                    name="external_item_unit_{{ external.id }}"
                    [(ngModel)]="external.Unit"
                    (change)="inputValueChange()"
                    readonly
                  />
                </td>
                <td>
                  <ibm-dropdown
                    placeholder="{{
                      external.Time ? external.Time : 'Select Time'
                    }}"
                    [dropUp]="false"
                    itemValueKey="content"
                    [invalid]="invalidTimeExternalItem[postIndex]"
                    invalidText="Time Required"
                    name="external_item_time_{{ external.id }}"
                    [(ngModel)]="external.Time"
                    [required]="requiredExternalItem[postIndex]"
                    (selected)="dropdownValueChange()"
                  >
                    <ibm-dropdown-list [items]="timeArr"></ibm-dropdown-list>
                  </ibm-dropdown>
                </td>
                <td>
                  <ibm-combo-box
                    placeholder="Select"
                    [dropUp]="false"
                    [items]="sitesList"
                    itemValueKey="content"
                    [invalid]="invalidLocationExternalItem[postIndex]"
                    invalidText="Location Required"
                    name="external_item_location_{{ external.id }}"
                    [(ngModel)]="external.Location"
                    [required]="requiredExternalItem[postIndex]"
                    (selected)="dropdownValueChange()"
                  >
                    <ibm-dropdown-list></ibm-dropdown-list>
                  </ibm-combo-box>
                </td>
                <td>
                  <ibm-checkbox
                    name="external_item_checkbox_{{ external.id }}"
                    [(ngModel)]="external.Selected"
                    (ngModelChange)="checkboxChange('externalItem', $event)"
                  >
                  </ibm-checkbox>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </ibm-table-container>
    </div>
  </div> -->

  <div ibmRow class="pt-32">
    <div ibmCol [columnNumbers]="{ lg: 10, md: 10, sm: 6 }">
      <div class="form-item">
        <div class="btn-action">
          <button
            type="button"
            ibmButton="secondary"
            style="margin-right: 24px"
            (click)="changeStep(0)"
          >
            Back
          </button>
          <button type="submit" ibmButton="primary" style="margin-right: 24px">
            Save
          </button>
          <button type="button" ibmButton="primary" (click)="changeStep(2)">
            Preview
          </button>
        </div>
      </div>
    </div>
  </div>
</form>
